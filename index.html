<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Enviar Ubicación</title>
</head>
<body>
  <h1>Enviando tu ubicación...</h1>
  <p id="estado">Esperando ubicación del navegador...</p>

  <script>
    const webhookURL = "https://script.google.com/macros/s/AKfycbydB5UM4fPIElase83hvDpbLrJcNjKqAYS2s0rBOjoHbub5Kdk0C1ajwHmUzQYo2vq0/exec"; // cambia esto

    function enviarUbicacion(lat, lon) {
      const ahora = new Date();
      const fecha = ahora.toISOString().split("T")[0];
      const hora = ahora.toTimeString().split(" ")[0];

      const url = `${webhookURL}?fecha=${fecha}&hora=${hora}&latitud=${lat}&longitud=${lon}`;

      fetch(url)
        .then(res => res.text())
        .then(data => {
          document.getElementById("estado").innerText = "Ubicación enviada correctamente.";
        })
        .catch(err => {
          document.getElementById("estado").innerText = "Error al enviar ubicación: " + err;
        });
    }

    function pedirUbicacion() {
      if ("geolocation" in navigator) {
        navigator.geolocation.getCurrentPosition(pos => {
          const lat = pos.coords.latitude;
          const lon = pos.coords.longitude;
          document.getElementById("estado").innerText = `Ubicación obtenida: ${lat}, ${lon}`;
          enviarUbicacion(lat, lon);
        }, err => {
          document.getElementById("estado").innerText = "Error al obtener ubicación: " + err.message;
        });
      } else {
        document.getElementById("estado").innerText = "Tu navegador no soporta geolocalización.";
      }
    }

    pedirUbicacion();
  </script>
</body>
</html>
